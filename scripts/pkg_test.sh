#!/usr/bin/bash
printf "////////////////////////////////////////////////////////////////////////////////"
docker-compose -f ./build/docker-compose.yml up --build -d
printf "////////////////////////////////////////////////////////////////////////////////"
sleep 5s
printf "\nRun API tests:\n"
go test ./tests -failfast -timeout 3s -v -run 'API'
printf "\nRun single-room stress tests:\n"
go test ./tests -failfast -timeout 60s -v -run 'Users'
printf "\nRun many-rooms stress tests:\n"
go test ./tests -failfast -timeout 60s -v -run 'ManyRooms'
printf "\n////////////////////////////////////////////////////////////////////////////////"
docker-compose -f ./build/docker-compose.yml down
echo "////////////////////////////////////////////////////////////////////////////////"